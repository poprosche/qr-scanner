(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{149:function(e,t,a){e.exports=a(209)},209:function(e,t,a){"use strict";a.r(t);a(150),a(175);var n=a(0),r=a.n(n),s=a(17),o=a.n(s),c=a(13),u=a.n(c),l=a(37),i=a(19),d=a.n(i),p=a(35),b=a(79),f=a(80),m=a(89),M=a(81),h=a(90),v=a(14),g=(a(191),a(88)),A=a.n(g),R=function(e){var t=e.activeModal,a=e.currentTitle,n=e.currentCaption,s=e.actionFlag,o=e.onCloseModal,c=e.onAction,u=e.currentButtonText;return r.a.createElement(v.f,{activeModal:t},r.a.createElement(v.e,{id:"MY_MODAL",onClose:function(){return o()},title:a,caption:n,actions:[{title:u,type:"primary",action:function(){return c(s)}}]}))},w={group_id:185199781},k={access_token:"9b1957fb4a56d227f2d894046db9b8aa12b7dafbbf6f606c0f7af580dcc06cf12862881c158bc4cf82e09"},_={access_token:"59f1b2e059f1b2e059f1b2e0c5599da582559f159f1b2e004b9e79590e7db44bab8b30c"},G={v:"5.101"},S=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(m.a)(this,Object(M.a)(t).call(this,e))).startScanFlow=function(){a.openQRScanner()},a.handleQRResult=Object(p.a)(d.a.mark(function e(){var t,n=arguments;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=n.length>0&&void 0!==n[0]?n[0]:"1111111",a.setState({QRResult:t}),a.sendQRResult(t);case 3:case"end":return e.stop()}},e)})),a.sendQRResult=Object(p.a)(d.a.mark(function e(){var t,n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state,n=t.QRResult,r=t.fetchedUser,e.prev=1,e.next=4,A.a.get("https://reqres.in/api/users",{qr:n,user:r});case 4:a.QRSuccessModal(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0);case 10:case"end":return e.stop()}},e,null,[[1,7]])})),a.activateModal=function(){a.setState({activeModal:"MY_MODAL"})},a.closeModal=function(){a.setState({activeModal:null})},a.joinToGroup=function(){u.a.send("VKWebAppJoinGroup",w)},a.openQRScanner=function(){setTimeout(function(){u.a.send("VKWebAppOpenQR",{})},300)},a.handleModalAction=function(e){a.closeModal(),{joinGroup:function(){return a.joinToGroup()},qrSuccess:function(){return a.openQRScanner()}}[e]()},a.activateJoinGroupModal=function(){a.setState({currentTitle:"\u0412\u0441\u0442\u0443\u043f\u043b\u0435\u043d\u0438\u0435 \u0432 \u0433\u0440\u0443\u043f\u043f\u0443",currentCaption:"\u0414\u043b\u044f \u043d\u0430\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f \u0431\u0430\u043b\u043e\u0432 \u043f\u043e\u0434\u043f\u0438\u0448\u0438\u0442\u0435\u0441\u044c \u043d\u0430 \u0433\u0440\u0443\u043f\u043f\u0443 \u0438 \u0440\u0430\u0441\u0441\u044b\u043b\u043a\u0443",currentButtonText:"\u0412\u0441\u0442\u0443\u043f\u0438\u0442\u044c",actionFlag:"joinGroup"}),a.activateModal()},a.QRSuccessModal=function(){a.setState({currentTitle:"\u0427\u0435\u043a \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d",currentCaption:"\u0412 \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u043c\u044b \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u043c \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443 \u0438 \u043d\u0430\u0447\u0438\u0441\u043b\u0438\u043c \u0431\u0430\u043b\u044b",currentButtonText:"\u0421\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0435\u0449\u0435",actionFlag:"qrSuccess"}),a.activateModal()},a.memberCheck=function(){var e=a.state.fetchedUser;u.a.send("VKWebAppCallAPIMethod",{method:"groups.isMember",request_id:"groups.isMember",params:Object(l.a)({user_id:e.id},w,_,G)})},a.messagesAllowedCheck=function(){var e=a.state.fetchedUser;u.a.send("VKWebAppCallAPIMethod",{method:"messages.isMessagesFromGroupAllowed",request_id:"messages.isMessagesFromGroupAllowed",params:Object(l.a)({request_id:"messages.isMessagesFromGroupAllowed",user_id:e.id},k,G,w)})},a.state={activePanel:"home",fetchedUser:null,activeModal:null,QRResult:null,currentTitle:"",currentCaption:"",actionFlag:""},a}return Object(h.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.startScanFlow(),u.a.subscribe(function(){var t=Object(p.a)(d.a.mark(function t(a){var n;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=a.detail,t.t0=n.type,t.next="VKWebAppGetUserInfoResult"===t.t0?4:"VKWebAppAllowMessagesFromGroupResult"===t.t0?8:"VKWebAppJoinGroupResult"===t.t0?10:"VKWebAppOpenQRResult"===t.t0?12:"VKWebAppCallAPIMethodResult"===t.t0?14:19;break;case 4:return e.setState({fetchedUser:n.data}),e.memberCheck(),e.messagesAllowedCheck(),t.abrupt("break",20);case 8:return"messages.isMessagesFromGroupAllowed"===n.data.request_id&&n.data.result&&e.QRSuccessModal(),t.abrupt("break",20);case 10:return n.data.result&&e.sendQRResult(),t.abrupt("break",20);case 12:return n.data.qr_data&&e.handleQRResult(n.data.qr_data),t.abrupt("break",20);case 14:return"groups.isMember"===n.data.request_id&&0===n.data.response&&e.activateJoinGroupModal(),"groups.isMember"===n.data.request_id&&1===n.data.response&&e.sendQRResult(),"messages.isMessagesFromGroupAllowed"===n.data.request_id&&1===n.data.response.is_allowed&&e.QRSuccessModal(),"messages.isMessagesFromGroupAllowed"===n.data.request_id&&0===n.data.response.is_allowed&&u.a.send("VKWebAppAllowMessagesFromGroup",Object(l.a)({request_id:"messages.isMessagesFromGroupAllowed"},w)),t.abrupt("break",20);case 19:return t.abrupt("break",20);case 20:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),u.a.send("VKWebAppGetUserInfo",{})}},{key:"render",value:function(){var e=this.state,t=e.fetchedUser,a=e.activeModal,n=e.currentTitle,s=e.currentCaption,o=e.actionFlag,c=e.currentButtonText,u=e.activePanel;return r.a.createElement(v.i,{activePanel:u},r.a.createElement(v.g,{id:"home"},r.a.createElement(v.h,null,"Scanner"),t&&r.a.createElement(v.c,{title:"Welcome"},r.a.createElement(v.d,{before:t.photo_200?r.a.createElement(v.a,{src:t.photo_200}):null,description:t.city&&t.city.title?t.city.title:""},"".concat(t.first_name," ").concat(t.last_name))),r.a.createElement(v.b,{onClick:this.startScanFlow,size:"xl",level:"primary"},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0447\u0435\u043a"),r.a.createElement(R,{activeModal:a,currentTitle:n,currentCaption:s,actionFlag:o,currentButtonText:c,onCloseModal:this.closeModal,onAction:this.handleModalAction})))}}]),t}(r.a.Component);u.a.send("VKWebAppInit",{}),console.log("kek",u.a.send("VKWebAppGetUserInfo",{})),o.a.render(r.a.createElement(S,null),document.getElementById("root"))}},[[149,1,2]]]);
//# sourceMappingURL=main.f732a592.chunk.js.map