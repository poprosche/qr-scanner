(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{150:function(e,t,s){e.exports=s(210)},210:function(e,t,s){"use strict";s.r(t);s(151),s(176);var a=s(0),n=s.n(a),o=s(17),r=s.n(o),c=s(13),i=s.n(c),l=s(35),u=s(45),d=s.n(u),p=s(78),f=s(79),h=s(80),b=s(90),m=s(81),M=s(91),g=s(14),A=(s(192),s(89)),R=s.n(A),v=function(e){var t=e.activeModal,s=e.currentTitle,a=e.currentCaption,o=e.actionFlag,r=e.onCloseModal,c=e.onAction,i=e.currentButtonText;return n.a.createElement(g.e,{activeModal:t},n.a.createElement(g.d,{id:"MY_MODAL",onClose:function(){return r()},title:s,caption:a,actions:[{title:i,type:"primary",action:function(){return c(o)}}]}))},w={group_id:185199781},_={access_token:"9b1957fb4a56d227f2d894046db9b8aa12b7dafbbf6f606c0f7af580dcc06cf12862881c158bc4cf82e09"},S={access_token:"59f1b2e059f1b2e059f1b2e0c5599da582559f159f1b2e004b9e79590e7db44bab8b30c"},G={v:"5.101"},k=function(e){function t(e){var s;return Object(f.a)(this,t),(s=Object(b.a)(this,Object(m.a)(t).call(this,e))).startScanFlow=function(){s.openQRScanner()},s.handleQRResult=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"1111111";s.setState({QRResult:e}),s.sendQRResult(s.state.QRResult)},s.sendQRResult=Object(p.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.a.get("https://reqres.in/api/users",{qr:s.state.QRResult,user:s.state.fetchedUser});case 3:s.QRSuccessModal(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}},e,null,[[0,6]])})),s.activateModal=function(){s.setState({activeModal:"MY_MODAL"})},s.closeModal=function(){s.setState({activeModal:null})},s.joinToGroup=function(){i.a.send("VKWebAppJoinGroup",w)},s.openQRScanner=function(){setTimeout(function(){i.a.send("VKWebAppOpenQR")},300)},s.handleModalAction=function(e){s.closeModal(),{joinGroup:function(){return s.joinToGroup()},qrSuccess:function(){return s.openQRScanner()}}[e]()},s.activateJoinGroupModal=function(){s.setState({currentTitle:"\u0412\u0441\u0442\u0443\u043f\u043b\u0435\u043d\u0438\u0435 \u0432 \u0433\u0440\u0443\u043f\u043f\u0443",currentCaption:"\u0414\u043b\u044f \u043d\u0430\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f \u0431\u0430\u043b\u043e\u0432 \u043f\u043e\u0434\u043f\u0438\u0448\u0438\u0442\u0435\u0441\u044c \u043d\u0430 \u0433\u0440\u0443\u043f\u043f\u0443 \u0438 \u0440\u0430\u0441\u0441\u044b\u043b\u043a\u0443",currentButtonText:"\u0412\u0441\u0442\u0443\u043f\u0438\u0442\u044c",actionFlag:"joinGroup"}),s.activateModal()},s.QRSuccessModal=function(){s.setState({currentTitle:"\u0427\u0435\u043a \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d",currentCaption:"\u0412 \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u043c\u044b \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u043c \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443 \u0438 \u043d\u0430\u0447\u0438\u0441\u043b\u0438\u043c \u0431\u0430\u043b\u044b",currentButtonText:"\u0421\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0435\u0449\u0435",actionFlag:"qrSuccess"}),s.activateModal()},s.memberCheck=function(){i.a.send("VKWebAppCallAPIMethod",{method:"groups.isMember",request_id:"groups.isMember",params:Object(l.a)({user_id:s.state.fetchedUser.id},w,S,G)})},s.messagesAllowedCheck=function(){i.a.send("VKWebAppCallAPIMethod",{method:"messages.isMessagesFromGroupAllowed",request_id:"messages.isMessagesFromGroupAllowed",params:Object(l.a)({request_id:"messages.isMessagesFromGroupAllowed",user_id:s.state.fetchedUser.id},_,G,w)})},s.state={activePanel:"home",isMember:!1,isMessagesAllowed:!1,fetchedUser:null,activeModal:null,QRResult:null,currentTitle:"",currentCaption:"",actionFlag:"",areaVal:""},s}return Object(M.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.startScanFlow(),this.memberCheck(),this.messagesAllowedCheck(),i.a.subscribe(function(t){var s=t.detail;switch(s.type){case"VKWebAppGetUserInfoResult":e.setState({fetchedUser:s.data});break;case"VKWebAppAllowMessagesFromGroupResult":"messages.isMessagesFromGroupAllowed"===s.data.request_id&&s.data.result&&(e.setState({isMessagesAllowed:!0}),e.QRSuccessModal());break;case"VKWebAppJoinGroupResult":s.data.result&&e.sendQRResult();break;case"VKWebAppOpenQRResult":e.handleQRResult(s.data.qr_reult);break;case"VKWebAppCallAPIMethodResult":"groups.isMember"===s.data.request_id&&0===s.data.response&&e.activateJoinGroupModal(),"groups.isMember"===s.data.request_id&&1===s.data.response&&(e.setState({isMember:!0}),e.sendQRResult()),"messages.isMessagesFromGroupAllowed"===s.data.request_id&&1===s.data.response.is_allowed&&(e.setState({isMessagesAllowed:!0}),e.QRSuccessModal()),"messages.isMessagesFromGroupAllowed"===s.data.request_id&&0===s.data.response.is_allowed&&i.a.send("VKWebAppAllowMessagesFromGroup",Object(l.a)({request_id:"messages.isMessagesFromGroupAllowed"},w));break;default:console.log("default")}}),i.a.send("VKWebAppGetUserInfo",{})}},{key:"render",value:function(){return n.a.createElement(g.h,{activePanel:this.state.activePanel},n.a.createElement(g.f,{id:"home"},n.a.createElement(g.g,null,"Scanner"),this.state.fetchedUser&&n.a.createElement(g.b,{title:"Welcome"},n.a.createElement(g.c,{before:this.state.fetchedUser.photo_200?n.a.createElement(g.a,{src:this.state.fetchedUser.photo_200}):null,description:this.state.fetchedUser.city&&this.state.fetchedUser.city.title?this.state.fetchedUser.city.title:""},"".concat(this.state.fetchedUser.first_name," ").concat(this.state.fetchedUser.last_name))),n.a.createElement(v,{activeModal:this.state.activeModal,currentTitle:this.state.currentTitle,currentCaption:this.state.currentCaption,actionFlag:this.state.actionFlag,currentButtonText:this.state.currentButtonText,onCloseModal:this.closeModal,onAction:this.handleModalAction})))}}]),t}(n.a.Component);i.a.send("VKWebAppInit",{}),console.log("kek",i.a.send("VKWebAppGetUserInfo",{})),r.a.render(n.a.createElement(k,null),document.getElementById("root"))}},[[150,1,2]]]);
//# sourceMappingURL=main.cc99cb16.chunk.js.map